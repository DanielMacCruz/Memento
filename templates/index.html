<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leonard's Blackbook</title>
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>
    <div class="app">
        <!-- Top Bar -->
        <header class="topbar">
            <div class="topbar-left">
                <h1 class="logo">Leonard's Blackbook</h1>
                <div class="status-indicators">
                    <span class="status-pill" id="status-pill">
                        <span class="status-dot"></span>
                        <span id="status-text">Dormant</span>
                    </span>
                    <span class="interface-pill" id="interface-pill">No Interface</span>
                    <!-- Inline Portal Status (hidden by default) -->
                    <span class="portal-pill" id="portal-banner" style="display:none;">
                        <span class="portal-pill-icon">üëª</span>
                        <span class="portal-pill-ssid" id="portal-banner-ssid">--</span>
                        <span class="portal-pill-sep">|</span>
                        <span class="portal-pill-mac" id="portal-banner-mac">--</span>
                        <span class="portal-pill-sep">|</span>
                        <span class="portal-pill-ch">CH<span id="portal-banner-channel">--</span></span>
                        <span class="portal-pill-sep">|</span>
                        <span class="portal-pill-cap"><span id="portal-banner-captured">0</span> caught</span>
                        <button class="portal-pill-stop" id="btn-portal-stop" title="Close Gate">‚úï</button>
                    </span>
                </div>
            </div>
            <div class="topbar-right">
                <div class="stats-bar">
                    <div class="stat-item">
                        <span class="stat-num" id="stat-scanned">0</span>
                        <span class="stat-lbl">Spotted</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-num" id="stat-attacked">0</span>
                        <span class="stat-lbl">Hunted</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-num" id="stat-captured">0</span>
                        <span class="stat-lbl">Trapped</span>
                    </div>
                    <div class="stat-item highlight">
                        <span class="stat-num" id="stat-cracked">0</span>
                        <span class="stat-lbl">Solved</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-num" id="stat-uptime">--:--</span>
                        <span class="stat-lbl">Elapsed</span>
                    </div>
                </div>
                <button class="btn btn-vigilance" id="btn-vigilance"
                    title="Constant passive scanning and listening for handshakes">
                    <span id="vigilance-label">Vigilance</span>
                </button>
                <select id="pressure-level" class="topbar-select" title="Interrogation Pressure (deauth packets)">
                    <option value="8">Gentle (8)</option>
                    <option value="16" selected>Firm (16)</option>
                    <option value="32">Heavy (32)</option>
                    <option value="64">Brutal (64)</option>
                </select>
                <button class="icon-btn" id="btn-settings" title="Configuration">‚öôÔ∏è</button>
            </div>
        </header>


        <!-- Main Content -->
        <main class="main-content">
            <!-- Column 1: Suspects (Networks) -->
            <section class="panel networks-panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <h2>Suspects</h2>
                        <span class="panel-count" id="network-count">0</span>
                    </div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" id="btn-scan">
                            <span class="btn-icon">‚óâ</span> Remember
                        </button>
                        <button class="btn btn-danger" id="btn-stop" disabled>
                            <span class="btn-icon">‚ñ†</span> Forget
                        </button>
                        <div class="attack-dropdown" id="attack-dropdown-container">
                            <button class="btn btn-attack" id="btn-attack">
                                <span id="attack-label">Interrogate</span>
                            </button>
                            <div class="dropdown-menu" id="attack-menu">
                                <div class="dropdown-item" data-mode="selected">Selected</div>
                                <div class="dropdown-item" data-mode="visible">All visible</div>
                                <div class="dropdown-item" data-mode="no-hash">Unmarked</div>
                            </div>
                        </div>
                        <button class="btn btn-ghost" id="btn-cancel-selection" style="display:none;">X Abort</button>
                    </div>
                </div>

                <div class="filters-bar">
                    <input type="text" class="filter-input" id="filter-essid" placeholder="Search memories...">
                    <select class="filter-select" id="filter-sort">
                        <option value="power">Signal ‚Üì</option>
                        <option value="newest">Newest</option>
                        <option value="essid">Name</option>
                    </select>
                    <label class="filter-toggle">
                        <input type="checkbox" id="filter-clients"> With witnesses
                    </label>
                    <!-- Ghosts filter disabled - all networks are persistent now
                    <label class="filter-toggle">
                        <input type="checkbox" id="filter-cached" checked> Show ghosts
                    </label>
                    -->
                    <div class="filter-slider">
                        <span>‚â• <strong id="power-display">-99</strong> dBm</span>
                        <input type="range" id="power-filter" min="-99" max="-30" value="-99">
                    </div>
                </div>

                <div class="panel-body" id="networks-container">
                    <div class="empty-state">
                        <div class="empty-icon">[~]</div>
                        <p>No suspects found</p>
                        <small>Click Remember to scan your surroundings</small>
                    </div>
                </div>
            </section>

            <!-- Column 2: Field Notes (Activity Log) -->
            <section class="panel log-panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <h2>Field Notes</h2>
                    </div>
                    <div class="panel-actions">
                        <label class="filter-toggle">
                            <input type="checkbox" id="log-autoscroll" checked> Auto-follow
                        </label>
                        <button class="btn btn-ghost btn-sm" id="btn-clear-log">Burn</button>
                    </div>
                </div>
                <div class="panel-body log-body" id="log-container">
                    <div class="log-entry log-info">
                        <span class="log-time">--:--:--</span>
                        <span class="log-msg">Awaiting instructions...</span>
                    </div>
                </div>
            </section>

            <!-- Column 3: Evidence Locker (Cracking) - FULL HEIGHT -->
            <div class="right-column">
                <section class="panel cracking-panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <h2>Evidence Locker</h2>
                            <span class="panel-count" id="hash-count">0</span>
                            <select class="filter-select hash-sort" id="hash-sort" title="Sort evidence">
                                <option value="time-desc">Newest ‚Üì</option>
                                <option value="time-asc">Oldest ‚Üë</option>
                                <option value="essid-asc">ESSID A-Z</option>
                                <option value="essid-desc">ESSID Z-A</option>
                            </select>
                        </div>
                        <div class="panel-actions">
                            <button class="btn btn-vigilance" id="btn-auto-solve"
                                title="Auto-solve hashes using wordlist+rule combinations">
                                <span id="auto-solve-label">Anterograde Amnesia</span>
                            </button>
                            <button class="btn btn-secondary" id="btn-wordlist" title="Fabricate Wordlist">
                                <span>Fabricate</span>
                            </button>
                            <button class="btn btn-ghost" id="btn-deduplicate" title="Merge redundant files and remove duplicate hashes">
                                <span>Clean</span>
                            </button>
                            <div class="attack-dropdown" id="crack-all-dropdown-container">
                                <button class="btn btn-primary" id="btn-crack-all">
                                    <span id="crack-all-label">Solve Cases</span>
                                </button>
                                <div class="dropdown-menu" id="crack-all-menu">
                                    <div class="dropdown-item" data-mode="selected">Select cases</div>
                                    <div class="dropdown-item" data-mode="all">Solve all unsolved</div>
                                </div>
                            </div>
                            <button class="btn btn-ghost" id="btn-cancel-crack-selection" style="display:none;">X
                                Abort</button>
                        </div>
                    </div>
                    <div class="panel-body" id="hashes-container">
                        <div class="empty-state compact">
                            <p>No evidence collected</p>
                            <small>Interrogate suspects to gather evidence</small>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settings-modal">
        <div class="modal-backdrop"></div>
        <div class="modal-dialog modal-lg">
            <div class="modal-header">
                <h3>Configuration</h3>
                <button class="modal-close" id="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Frequency Band</label>
                    <select id="setting-band">
                        <option value="abg">2.4GHz + 5GHz</option>
                        <option value="a">5GHz only</option>
                        <option value="bg">2.4GHz only</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Wireless Interface</label>
                    <select id="setting-interface">
                        <option value="">Auto-detect</option>
                    </select>
                    <small>Select your listening device</small>
                </div>

                <div class="settings-divider"></div>
                <h4 class="settings-section-title">üëª Phantom Gate</h4>

                <div class="form-group">
                    <label>Internet Source</label>
                    <select id="setting-portal-in">
                        <option value="">Select adapter...</option>
                    </select>
                    <small>Your internet connection (eth0, wwan0, etc)</small>
                </div>
                <div class="form-group">
                    <label>Evil Twin Adapter</label>
                    <select id="setting-portal-out">
                        <option value="">Select adapter...</option>
                    </select>
                    <small>Wireless adapter for fake AP (requires AP mode support)</small>
                </div>
                <div class="form-group">
                    <label class="filter-toggle">
                        <input type="checkbox" id="setting-portal-capture" checked>
                        Capture victim traffic
                    </label>
                    <small>Save all traffic to captures/portal_*.pcap</small>
                </div>
                <div class="form-group">
                    <label class="filter-toggle">
                        <input type="checkbox" id="setting-portal-forced">
                        Forced Mode
                    </label>
                    <small>Intercept ALL requests (otherwise only Google/Facebook)</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="btn-save-settings">Save</button>
            </div>
        </div>
    </div>


    <!-- Brgen Password Generator Modal -->
    <div class="modal" id="wordlist-modal">
        <div class="modal-backdrop"></div>
        <div class="modal-dialog">
            <div class="modal-header">
                <h3>Neural Fabrication</h3>
                <button class="modal-close" id="wordlist-close">√ó</button>
            </div>
            <div class="modal-body">
                <p class="modal-desc">Generate realistic passwords using PassGPT neural network.</p>

                <div class="form-group">
                    <label>Password Count</label>
                    <select id="wordlist-count">
                        <option value="1000">1,000 (Quick test)</option>
                        <option value="5000">5,000 (Small batch)</option>
                        <option value="10000" selected>10,000 (Standard)</option>
                        <option value="25000">25,000 (Medium)</option>
                        <option value="50000">50,000 (Large)</option>
                        <option value="100000">100,000 (Very Large)</option>
                        <option value="500000">500,000 (Huge)</option>
                        <option value="1000000">1,000,000 (Maximum)</option>
                    </select>
                    <small>More passwords = longer generation time</small>
                </div>

                <div class="form-group">
                    <label>Generation Mode</label>
                    <select id="wordlist-mode">
                        <option value="ordered" selected>SOPG Ordered (Probability ranked)</option>
                        <option value="random">Random Sampling (Fast)</option>
                    </select>
                    <small>Ordered mode generates passwords by probability - higher quality but slower</small>
                </div>

                <div class="form-group" id="temperature-group">
                    <label>Temperature: <span id="temp-display">1.0</span></label>
                    <input type="range" id="wordlist-temperature" min="0.5" max="1.5" step="0.1" value="1.0">
                    <small>Lower = more common passwords, Higher = more variety</small>
                </div>

                <div class="form-group" id="beam-group" style="display:none;">
                    <label>Beam Width</label>
                    <select id="wordlist-beam">
                        <option value="25">25 (Faster)</option>
                        <option value="50" selected>50 (Balanced)</option>
                        <option value="100">100 (Higher quality)</option>
                    </select>
                    <small>Higher beam = better probability ordering but slower</small>
                </div>

                <div class="info-box">
                    <strong>Model:</strong> <span id="wordlist-model-info">Brazilian fine-tuned PassGPT</span>
                </div>

                <div class="wordlist-status" id="wordlist-status" style="display:none;">
                    <div class="status-spinner"></div>
                    <span id="wordlist-status-text">Fabricating passwords...</span>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="wordlist-cancel">Cancel</button>
                <button class="btn btn-primary" id="btn-wordlist-generate">Fabricate</button>
            </div>
        </div>
    </div>


    <!-- Solve Cases Modal (Crack All) -->
    <div class="modal" id="crack-all-modal">
        <div class="modal-backdrop"></div>
        <div class="modal-dialog">
            <div class="modal-header">
                <h3>Solve Cases</h3>
                <button class="modal-close" id="crack-all-close">√ó</button>
            </div>
            <div class="modal-body">
                <p class="modal-desc">Select wordlist and rules to crack <strong id="crack-all-count">0</strong>
                    piece(s) of evidence.</p>

                <div class="form-group">
                    <label>Wordlist</label>
                    <select id="crack-all-wordlist">
                        <option value="">Select wordlist...</option>
                    </select>
                </div>

                <div class="form-group" id="crack-rule-group">
                    <label>Hashcat Rule (optional)</label>
                    <select id="crack-all-rule">
                        <option value="">None</option>
                    </select>
                    <small>Rules multiply the effective wordlist size</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="crack-all-cancel">Cancel</button>
                <button class="btn btn-primary" id="btn-execute-crack-all">Execute</button>
            </div>
        </div>
    </div>

    <!-- Auto-Solve Configuration Modal -->
    <div class="modal" id="autosolve-modal">
        <div class="modal-backdrop"></div>
        <div class="modal-dialog modal-lg">
            <div class="modal-header">
                <h3>Anterograde Amnesia</h3>
                <button class="modal-close" id="autosolve-close">√ó</button>
            </div>
            <div class="modal-body">
                <p class="modal-desc">Configure wordlist and rule priority. Already-attempted combos are skipped.</p>

                <div class="form-group">
                    <label>Wordlist Priority (drag to reorder)</label>
                    <div class="wordlist-queue" id="autosolve-queue">
                        <!-- Wordlists will be populated here -->
                    </div>
                </div>

                <div class="form-group">
                    <label>Rule Priority (drag to reorder)</label>
                    <div class="wordlist-queue" id="autosolve-rule-queue">
                        <!-- Rules will be populated here -->
                    </div>
                    <small>Top = applied first. Include "(no rule)" for raw wordlist attempts.</small>
                </div>

                <div class="form-group">
                    <label>AI Context Words (optional)</label>
                    <div class="ai-context-group">
                        <button class="btn btn-secondary btn-sm" id="btn-autosolve-ai">Add Context</button>
                        <span id="autosolve-context-status" class="context-status"></span>
                    </div>
                    <small>Generate context-specific passwords via AI chatbot</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="autosolve-cancel">Cancel</button>
                <button class="btn btn-primary" id="btn-autosolve-start">Start Amnesia</button>
            </div>
        </div>
    </div>

    <!-- AI Context Modal -->
    <div class="modal" id="ai-context-modal">
        <div class="modal-backdrop"></div>
        <div class="modal-dialog">
            <div class="modal-header">
                <h3>AI Context Words</h3>
                <button class="modal-close" id="ai-context-close">√ó</button>
            </div>
            <div class="modal-body">
                <p class="modal-desc">Generate passwords using AI. Copy the prompt, paste response.</p>

                <div class="form-group">
                    <label>Prompt to send to AI:</label>
                    <textarea id="ai-prompt-text" class="form-textarea" rows="5"
                        readonly>Generate 50 WiFi password candidates for a Brazilian network. Return as CSV (comma-separated, no spaces). Include: keyboard walks, number patterns, common words with suffixes. Example: qwerty123,12345678,senha1234</textarea>
                    <button class="btn btn-secondary btn-sm" id="btn-copy-prompt">Copy Prompt</button>
                </div>

                <div class="form-group">
                    <label>Paste AI response (CSV format):</label>
                    <textarea id="ai-response-text" class="form-textarea" rows="4"
                        placeholder="padariajoao,joao123,padaria2024"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="ai-context-cancel">Cancel</button>
                <button class="btn btn-primary" id="btn-ai-context-save">Save Context</button>
            </div>
        </div>
    </div>

    <!-- Phantom Gate (Evil Portal) Modal -->
    <div class="modal" id="portal-modal">
        <div class="modal-backdrop"></div>
        <div class="modal-dialog">
            <div class="modal-header">
                <h3>üëª Phantom Gate</h3>
                <button class="modal-close" id="portal-close">√ó</button>
            </div>
            <div class="modal-body">
                <p class="modal-desc">Launch Evil Twin for <strong id="portal-target-essid">Unknown</strong></p>

                <div class="portal-target-info">
                    <span>BSSID: <code id="portal-target-bssid">--</code></span>
                    <span>Channel: <code id="portal-target-channel">--</code></span>
                </div>

                <!-- Adapter Selection -->
                <div class="form-group">
                    <label>Internet Source</label>
                    <select id="portal-in-adapter">
                        <option value="">-- Select adapter --</option>
                    </select>
                    <small>Your internet connection (eth0, wwan0, etc)</small>
                </div>

                <div class="form-group">
                    <label>Evil Twin Adapter</label>
                    <select id="portal-out-adapter">
                        <option value="">-- Select adapter --</option>
                    </select>
                    <small>Wireless adapter for fake AP (must support AP mode)</small>
                </div>

                <div class="form-group">
                    <label>Mode</label>
                    <select id="portal-mode">
                        <option value="open">Open (Captive Portal)</option>
                        <option value="wpa2">WPA2 (Stealth)</option>
                    </select>
                    <small>WPA2 mode uses a known password for seamless connection</small>
                </div>

                <div class="form-group" id="portal-password-group" style="display:none;">
                    <label>WPA2 Password</label>
                    <input type="text" id="portal-password" placeholder="Enter cracked password">
                </div>



                <div class="form-group">
                    <label>Strategy</label>
                    <select id="portal-strategy">
                        <option value="karma" selected>Karma (Aggressive)</option>
                        <option value="stealth">Stealth (Obfuscated)</option>
                        <option value="passive">Passive (Patience)</option>
                    </select>
                    <small>
                        <strong>Karma:</strong> Captive Portal, forces sign-in popup.<br>
                        <strong>Stealth:</strong> Blocks HTTPS, redirects HTTP (Session Expired).<br>
                        <strong>Passive:</strong> Allows traffic, only phishes targets.
                    </small>
                </div>

                <div class="form-group">
                    <label class="filter-toggle">
                        <input type="checkbox" id="portal-clone-bssid" checked>
                        Clone BSSID (same MAC as target)
                    </label>
                </div>

                <div class="form-group">
                    <label class="filter-toggle">
                        <input type="checkbox" id="portal-deauth">
                        Enable Deauth Loop
                    </label>
                    <small>Continuously kick victims off real AP</small>
                </div>

                <div class="portal-status" id="portal-live-status" style="display:none;">
                    <div class="portal-status-header">
                        <div class="status-spinner"></div>
                        <span id="portal-status-text">Portal active...</span>
                    </div>
                    <div class="portal-credentials" id="portal-credentials">
                        <h5>Captured Credentials</h5>
                        <div id="portal-creds-list" class="creds-list"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="portal-cancel">Cancel</button>
                <button class="btn btn-danger" id="btn-portal-launch">
                    <span id="portal-launch-text">Open Gate</span>
                </button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>

</body>

</html>